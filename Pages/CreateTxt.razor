@page "/create/txt"
@using ScriptApp.Services
@inject ScriptService ScriptService

<div class="container mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">üìù –°–æ–∑–¥–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π (—Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)</h4>
        </div>
        <div class="card-body">
            <div class="mb-3">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è</label>
                <input class="form-control"
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ"
                       @bind="title" />
            </div>

            <div class="mb-3">
                <label class="form-label">–¢–µ–∫—Å—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è</label>
                <textarea class="form-control"
                          style="height: 300px; resize: none;"
                          placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..."
                          @bind="textContent"></textarea>
            </div>

            <button class="btn btn-success" @onclick="SaveText">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

            @if (!string.IsNullOrEmpty(link))
            {
                <div class="alert alert-info mt-3">
                    ‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω!  
                    –°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞: <a href="@link">@link</a>
                </div>
            }
        </div>
    </div>
</div>

@code {
    private string title = "";
    private string textContent = "";
    private string? link;

    private void SaveText()
    {
        var script = ScriptService.AddTextScript(title, textContent);
        link = $"/script/{script.Id}";
    }
}
